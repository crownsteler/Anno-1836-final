namespace = mexican_nfm

# Bear Flag Revolt
mexican_nfm.1 = {
	type = country_event
	placement = ROOT

	title = mexican_nfm.1.t
	desc = mexican_nfm.1.d
	flavor = mexican_nfm.1.f

	duration = 3

	event_image = {
		video = "europenorthamerica_springtime_of_nations"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	trigger = {
		exists = c:MEX
		c:MEX = ROOT
		c:MEX = { has_war_with = c:USA }
		c:MEX = { NOT = { has_variable = bear_flag_revolt_happened}}
		p:x1116AA.owner = c:MEX
	}

	immediate = {
		c:MEX = { set_variable = bear_flag_revolt_happened }
		create_country = {
			tag = CAL
			origin = this
			state = s:STATE_CALIFORNIA.region_state:MEX
		}
		s:STATE_CALIFORNIA = {
			set_owner_of_provinces = {
				country = c:MEX
				provinces = {  
					x108080 x1116AA x8CFB9B x8F1372 x2099C1 x0898A3 x4C2D30 xD00000 x8CC57E x25842F x3117AA x2F8F36 xC2E1AA x508000 xA45ACA	x908080 x76A57D x7BCC6D xF16E88
				}
			}
		}
		s:STATE_CALIFORNIA.region_state:CAL = {
			create_building = {
  				building = building_barrack
 				level = 2
  			}
		}
		s:STATE_CALIFORNIA.region_state:CAL = {
			create_pop = {
				pop_type = officers
				culture = yankee
				size = 200
			}
			create_pop = {
				pop_type = soldiers
				culture = yankee
				size = 2200
			}
		}

		s:STATE_CALIFORNIA.region_state:MEX  = {
			every_scope_pop = {
				limit = {
					OR = {
						culture = cu:dixie
						culture = cu:yankee
					}	
				}
				move_pop = s:STATE_CALIFORNIA.region_state:CAL
			}
		}
		c:CAL = {
			activate_law = law_type:law_national_militia
			activate_law = law_type:law_elected_bureaucrats 
			activate_law = law_type:law_freedom_of_conscience
			activate_law = law_type:law_racial_segregation
			activate_law = law_type:law_no_colonial_affairs
			activate_law = law_type:law_census_voting
			activate_law = law_type:law_laissez_faire 
			activate_law = law_type:law_private_schools
			activate_law = law_type:law_protected_speech 
			activate_law = law_type:law_presidential_republic
			activate_law = law_type:law_no_home_affairs
			activate_law = law_type:law_serfdom_banned
			activate_law = law_type:law_no_migration_controls 
			activate_law = law_type:law_local_police
			activate_law = law_type:law_women_own_property 
			activate_law = law_type:law_slavery_banned
			activate_law = law_type:law_per_capita_based_taxation 
			activate_law = law_type:law_free_trade
		}

		c:MEX = {
			create_diplomatic_play = {
				name = bear_flag_revolt_warname
			
				target_country = c:CAL
				type = dp_annex_war
				war = yes

				add_war_goal = {
					holder = c:CAL
					type = conquer_state
					target_state = s:STATE_CALIFORNIA.region_state:MEX
				}
				add_war_goal = {
					holder = c:CAL
					type = conquer_state
					target_state = s:STATE_NEVADA.region_state:MEX
				}
			}
		}
	}
	
	option = { # perhaps another time
		name = mexican_nfm.1.a
		default_option = yes
		ai_chance = {
			base = 1
		}
		
	}

}